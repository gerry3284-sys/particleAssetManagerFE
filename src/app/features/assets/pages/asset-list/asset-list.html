<div class="asset-page">
  <!-- Header -->
  <div class="page-header d-flex align-items-start justify-content-between gap-3">
    <div>
      <h2 class="page-title">Gestione asset</h2>
      <p class="page-subtitle">Visualizza e gestisci tutti gli asset aziendali.</p>
    </div>
    <button class="btn btn-new-asset" type="button" (click)="createNewAsset()">
      <span class="">+</span>
      <span>Nuovo Asset</span>
    </button>
  </div>

  <!-- Filtri -->
  <div class="filters-card">
    <div class="filters-grid">
      <div class="filter-item">
        <label class="filter-label">Tipologia Asset</label>
        <select class="form-select filter-control" [(ngModel)]="filters.typology">
          <option>Tutte le Tipologie</option>
        </select>
      </div>
      <div class="filter-item">
        <label class="filter-label">Business Unit</label>
        <select class="form-select filter-control" [(ngModel)]="filters.businessUnit">
          <option>Tutte le BU</option>
        </select>
      </div>
      <div class="filter-item">
        <label class="filter-label">Stato Asset</label>
        <select class="form-select filter-control" [(ngModel)]="filters.status">
          <option>Tutti gli Stati</option>
        </select>
      </div>
      <div class="filter-item">
        <label class="filter-label">Nome Assegnatario</label>
        <div class="input-with-icon">
          <svg class="input-icon" viewBox="0 0 24 24" fill="none">
            <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" />
            <path d="M20 20L16.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
          <input 
            class="form-control filter-control" 
            placeholder="Cerca per nome..." 
            [(ngModel)]="filters.searchName" />
        </div>
      </div>
    </div>
  </div>

  <!-- Tabella -->
  <div class="table-card">
    <div class="asset-table">
      <!-- Header -->
      <div class="asset-row asset-header">
        <div>Stato</div>
        <div>Marca</div>
        <div>Modello</div>
        <div>Numero seriale</div>
        <div>Utente assegnato</div>
        <div>Business Unit</div>
        <div>Data assegnazione</div>
      </div>

      <!-- âœ… RIGHE DINAMICHE -->
      @for (asset of paginatedAssets(); track asset.id) {
        <div 
          class="asset-row" 
          [class.muted]="asset.status === 'dismissed'"
          (click)="goToAssetDetail(asset.id)"
          style="cursor: pointer;">
          
          <!-- Colonna Stato -->
          <div class="status">
            @if (asset.status === 'assigned') {
              <span class="status-dot status-assigned"></span>
            } @else if (asset.status === 'available') {
              <span class="status-dot status-available"></span>
            } @else {
              <span class="status-box"></span>
            }
            <span>{{ asset.statusLabel }}</span>
          </div>
          
          <!-- Dati Asset -->
          <div>{{ asset.brand }}</div>
          <div>{{ asset.model }}</div>
          <div>{{ asset.serialNumber }}</div>
          <div>{{ asset.assignedUser || '-' }}</div>
          <div>{{ asset.businessUnit || '-' }}</div>
          <div>{{ asset.assignmentDate || '-' }}</div>
        </div>
      }
    </div>

    <!-- Footer con paginazione -->
    <div class="table-footer">
      <span class="table-info">{{ displayRange() }}</span>
      
      <app-pagination
        [currentPage]="currentPage()"
        [totalPages]="totalPages()"
        [maxVisible]="5"
        (pageChange)="goToPage($event)">
      </app-pagination>
    </div>
  </div>
</div>